<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="430" viewBox="0 0 1100 430" role="img" aria-label="Flujo de seguridad basica con firewalld y SELinux">
  <defs>
    <style>
      .title { font: 700 24px Arial, sans-serif; fill: #1f2937; }
      .subtitle { font: 500 14px Arial, sans-serif; fill: #374151; }
      .label { font: 700 15px Arial, sans-serif; fill: #111827; }
      .text { font: 14px Arial, sans-serif; fill: #1f2937; }
      .ok { fill: #dcfce7; stroke: #16a34a; stroke-width: 2; }
      .warn { fill: #fef9c3; stroke: #ca8a04; stroke-width: 2; }
      .risk { fill: #fee2e2; stroke: #dc2626; stroke-width: 2; }
      .neutral { fill: #e0e7ff; stroke: #4f46e5; stroke-width: 2; }
      .arrow { stroke: #4b5563; stroke-width: 2.5; fill: none; marker-end: url(#m); }
    </style>
    <marker id="m" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
      <path d="M0,0 L8,4 L0,8 z" fill="#4b5563"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1100" height="430" fill="#f8fafc"/>
  <text x="32" y="42" class="title">Seguridad basica RHEL: firewalld + SELinux</text>
  <text x="32" y="66" class="subtitle">En troubleshooting: comprobar por capas y evitar desactivar controles por defecto</text>

  <rect x="35" y="105" width="220" height="92" rx="12" class="neutral"/>
  <text x="50" y="134" class="label">1) Servicio activo</text>
  <text x="50" y="158" class="text">systemctl status httpd</text>
  <text x="50" y="178" class="text">ss -tulpen | grep :80</text>

  <rect x="290" y="105" width="220" height="92" rx="12" class="ok"/>
  <text x="305" y="134" class="label">2) Firewall zona</text>
  <text x="305" y="158" class="text">firewall-cmd --list-all</text>
  <text x="305" y="178" class="text">servicio/puerto abierto</text>

  <rect x="545" y="105" width="220" height="92" rx="12" class="warn"/>
  <text x="560" y="134" class="label">3) SELinux estado</text>
  <text x="560" y="158" class="text">getenforce / sestatus</text>
  <text x="560" y="178" class="text">Enforcing recomendado</text>

  <rect x="800" y="105" width="260" height="92" rx="12" class="ok"/>
  <text x="815" y="134" class="label">4) Contexto y puertos</text>
  <text x="815" y="158" class="text">ls -lZ /var/www/html</text>
  <text x="815" y="178" class="text">semanage port -l | grep http</text>

  <path d="M255 151 L290 151" class="arrow"/>
  <path d="M510 151 L545 151" class="arrow"/>
  <path d="M765 151 L800 151" class="arrow"/>

  <rect x="35" y="240" width="330" height="155" rx="12" class="risk"/>
  <text x="50" y="268" class="label">Antipatron frecuente</text>
  <text x="50" y="294" class="text">- Abrir puerto solo en runtime</text>
  <text x="50" y="318" class="text">- Desactivar SELinux para "arreglar"</text>
  <text x="50" y="342" class="text">- No validar desde cliente remoto</text>
  <text x="50" y="366" class="text">Resultado: incidencias recurrentes</text>

  <rect x="390" y="240" width="330" height="155" rx="12" class="ok"/>
  <text x="405" y="268" class="label">Patron recomendado</text>
  <text x="405" y="294" class="text">- Regla permanente + reload</text>
  <text x="405" y="318" class="text">- restorecon en contenido web</text>
  <text x="405" y="342" class="text">- mapear puertos SELinux cuando aplique</text>
  <text x="405" y="366" class="text">Resultado: servicio estable y seguro</text>

  <rect x="745" y="240" width="315" height="155" rx="12" class="neutral"/>
  <text x="760" y="268" class="label">Comandos clave</text>
  <text x="760" y="294" class="text">firewall-cmd --permanent --add-service=http</text>
  <text x="760" y="318" class="text">firewall-cmd --reload</text>
  <text x="760" y="342" class="text">restorecon -Rv /var/www/html</text>
  <text x="760" y="366" class="text">semanage port -a -t http_port_t -p tcp 8080</text>
</svg>
